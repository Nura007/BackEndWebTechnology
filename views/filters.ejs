<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>F1 Constructors</title>
    <link rel="stylesheet" href="/css/filters.css">
</head>
<body>

<h1>F1 Constructors Standings</h1>

<div class="filters">
    <input type="number" id="season" placeholder="Season (e.g. 2024)">
    <input type="text" id="team" placeholder="Team name">
    <input type="number" id="minPoints" placeholder="Min points">
    <input type="number" id="maxPoints" placeholder="Max points">

    <select id="fields">
        <option value="">All fields</option>
        <option value="team,drivers,points">Team + Drivers + Points</option>
        <option value="team,points,wins">Team + Points + Wins</option>
    </select>

    <button onclick="loadConstructors()">Filter</button>
</div>

<div id="results" class="results"></div>

<script>
async function loadConstructors() {
    const season = document.getElementById('season').value;
    const team = document.getElementById('team').value;
    const minPoints = document.getElementById('minPoints').value;
    const maxPoints = document.getElementById('maxPoints').value;
    const fields = document.getElementById('fields').value;

    let query = [];

    if (season) query.push(`season=${season}`);
    if (team) query.push(`team=${team}`);
    if (minPoints) query.push(`minPoints=${minPoints}`);
    if (maxPoints) query.push(`maxPoints=${maxPoints}`);
    if (fields) query.push(`fields=${fields}`);

    const url = `/api/constructors${query.length ? '?' + query.join('&') : ''}`;

    const res = await fetch(url);
    const data = await res.json();

    const results = document.getElementById('results');
    results.innerHTML = '';

    if (!data.data || data.data.length === 0) {
        results.innerHTML = '<p>No results found</p>';
        return;
    }

    data.data.forEach(c => {
        const card = document.createElement('div');
        card.className = 'card';

        card.innerHTML = `
            <h2>${c.team || 'Unknown Team'}</h2>
            <p><strong>Drivers:</strong> ${c.drivers ?? '-'}</p>
            <p><strong>Points:</strong> ${c.points ?? '-'}</p>
            <p><strong>Wins:</strong> ${c.wins ?? '-'}</p>
            <p><strong>Position:</strong> ${c.position ?? '-'}</p>
        `;

        results.appendChild(card);
    });
}

// Load default data
loadConstructors();
</script>

</body>
</html>
